{% extends 'page.html' %}

{% block include_header %}
    <style>
        .form-group {
            margin-bottom: .5rem;
        }
        .card-columns {
            -webkit-column-count:1;
            -moz-column-count:1;
            column-count:1;
        }
        .card-body {
            padding:.5rem 1rem 1.2rem 1rem;
        }
    </style>
{% endblock %}

{% block page_title %}Обновить заявку №{{ proposal.pk }}{% endblock %}
{% block section_active %}Эксплуатация{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-4 p-10">
                <div class="card-columns">
                    <div class="card">
                        <div class="card-body p-10">
                            <h6 class="card-title">Объект</h6>
                            <p class="h5">{{ proposal.Client_words }}</p>
                            <p class="card-text">{{ proposal.NumObject }} ({{ proposal.AddressObject }})</p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body p-10">
                            <h6 class="card-title">Описание неисправности</h6>
                            <p class="card-text overflow-auto">{{ proposal.DescriptTroubles }}</p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body p-10">
                            <h6 class="card-title">Добавлено</h6>
                            <p class="card-text overflow-auto">{{ proposal.CreateUser }} <small>{{ proposal.DateTimeAdd|date:"d.m.Y" }}</small></p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body p-10">
                            <h6 class="card-title">Обновлено</h6>
                            <p class="card-text overflow-auto">{{ proposal.UpdateUser }} <small>{{ proposal.DateTimeUpd|date:"d.m.Y" }}</small></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-8 p-10">
                <div class="row">
                    <div class="card">
                        <div class="card-body" style="padding:1rem 1rem 1rem 1rem;">
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-3" style="padding-top: 5px;">
                                        <label>Даты</label>
                                    </div>
                                    <div class="col-9">
                                        Выполнить {{ proposal.DateTime_schedule }}
                                    </div>
                                    <div class="col-9 offset-3">
                                        Выполнено {{ proposal.DateTime_work }}
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-3" style="padding-top: 5px;">
                                        <label>Описание исполнения</label>
                                    </div>
                                    <div class="col-9">
                                        {{ proposal.DescriptWorks }}
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-3" style="padding-top: 5px;">
                                        <label>Исполнители</label>
                                    </div>
                                    <div class="col-9">
                                        {% for cowork in proposal.CoWorkers.all %}
                                            {% if not forloop.first %}, {% endif %}{{ cowork.Person_FIO }}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-3" style="padding-top: 5px;">
                                        <label>Состояние</label>
                                    </div>
                                    <div class="col-9">
                                        {{ proposal.Status }}
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-3">
                                        <label>Акт</label>
                                    </div>
                                    <div class="col-6">
                                        {% if proposal.WrittenAct %}
                                            Акт выписан от {{ Date_act }}
                                        {% else %}
                                            не требуется
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="row">
                                <div class="col-4 offset-8">
                                    <a type="button" class="btn btn-secondary" href="#">Закрыть заявку</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}